# Задачи для бота HorniMine

## 1. Завершение системы заявок (Заявки)
- [x] Основная логика создания и редактирования заявок
- [x] Просмотр статуса заявок пользователями
- [ ] Доработка логики платформ (Java/Bedrock/Обе)
  - [ ] Добавить запрос информации о платформе в процессе создания заявки
  - [ ] Добавить запрос соответствующих никнеймов в зависимости от выбранной платформы
  - [ ] Сохранять информацию о платформе в базе данных (создать новый столбец)
- [ ] Автоматическая отправка команд вайтлиста в Minecraft
  - [ ] Команда /whitelist add <nickname> для Java
  - [ ] Команда /fwhitelist add <nickname> для Bedrock
  - [ ] Реализовать подключение к серверу Minecraft

## 2. Исправление ошибок в системе поддержки (Поддержка)
- [x] Создание тикетов и обмен сообщениями
- [x] Просмотр тикетов в панели администратора
- [x] Исправление ошибок в обработчиках
  - [x] Устранить ошибку "get_main_menu is not defined" в функции close_support_ticket
  - [x] Исправить ошибку "get_application_media_keyboard() missing required 'is_edit' parameter"
  - [x] Добавить обработчик view_ticket в handlers_admin.py
  - [x] Исправить ошибки с chat_ticket_X callback в админ-панели
  - [x] Улучшено перенаправление между handlers_support.py и handlers_admin.py
  - [x] Добавлено корректное обнуление callback.answer() для предотвращения зависания часиков
- [x] Улучшение очистки старых сообщений
  - [x] Более надежная система удаления предыдущих сообщений бота
  - [x] Добавить обработку ошибок при удалении
- [x] Реализация полноценной системы чата администратора с пользователем
  - [x] Исправление кнопок "Перейти в чат" и "Закрыть вопрос"
  - [x] Улучшенная обработка состояний в чате
  - [x] Единообразие терминологии (замена слова "запрос" на "вопрос")
  - [x] Добавлена отправка уведомления пользователю при входе админа в чат
  - [x] Исправлена обработка различных типов сообщений в чате
  - [x] Улучшена обработка ошибок в чате администратора

## 3. Доработка панели администратора (Админ-панель)
- [x] Просмотр и обработка заявок по категориям (Ожидающие, Одобренные, Отклонённые)
- [x] Базовая работа с тикетами поддержки
- [x] Исправление ошибок в обработчиках callback-запросов
  - [x] Решение проблем с "Необработанный callback: chat_ticket_X от админа"
  - [x] Добавление обработчика для "view_ticket_X" в handlers_admin.py
  - [x] Улучшена обработка неизвестных callback-запросов
- [ ] Добавление раздела управления бэкапами
  - [ ] История бэкапов
  - [ ] Создание бэкапа бота
  - [ ] Создание бэкапа сервера Minecraft

## 4. Система бэкапов (Бэкапы)
- [ ] Создание интерфейса для управления бэкапами
  - [ ] Добавить кнопку "Бэкапы" в админ-меню
  - [ ] Создать клавиатуру для управления бэкапами
- [ ] Реализация создания резервных копий
  - [ ] Архивирование кода бота (tar архив)
  - [ ] Архивирование папки с сервером Minecraft
  - [ ] Создание БД для хранения информации о бэкапах
- [ ] Возможность просмотра и скачивания бэкапов
  - [ ] Список ранее созданных копий
  - [ ] Возможность удаления старых копий

## 5. Улучшение пользовательского интерфейса
- [x] Основное меню с правильными кнопками
- [x] Навигация с кнопками "Назад"
- [x] Более чистый интерфейс с удалением старых сообщений
  - [x] Устранить дублирование сообщений
  - [x] Обеспечить корректное удаление предыдущих сообщений при навигации
- [x] Улучшение текстов интерфейса
  - [x] Заменить слово "запрос" на "вопрос" во всех сообщениях
  - [x] Использовать более понятные названия для кнопок
- [ ] Улучшение медиа-компонентов
  - [ ] Предпросмотр прикреплённых файлов
  - [ ] Поддержка различных типов медиа в тикетах

## 6. Исправление ошибок и повышение стабильности
- [x] Решение проблемы "Update id=XXXXX is not handled"
  - [x] Добавить обработчики для всех callback-запросов
  - [x] Добавить дефолтные обработчики для неизвестных callback-запросов
  - [x] Исправлены проблемы с перенаправлением callback запросов между роутерами
- [x] Обработка ошибок при доступе к базе данных
  - [x] Добавить try-except блоки где необходимо
  - [x] Добавить логирование для всех операций с БД
- [x] Общее повышение надежности
  - [x] Проверка на null перед обращением к объектам
  - [x] Безопасное удаление сообщений с корректной обработкой ошибок
  - [x] Улучшена проверка состояний и более подробное логирование
- [x] Исправление проблемы с командой /start
  - [x] Обеспечение корректной обработки команды в обоих роутерах
  - [x] Улучшение фильтрации сообщений для избежания конфликтов
- [x] Улучшение обработки разных типов сообщений
  - [x] Добавление утилитарной функции get_message_content_and_type
  - [x] Улучшение функции send_media_message для медиа-контента
  - [x] Добавлена обработка ошибок при отправке сообщений

## 7. Тестирование и запуск
- [ ] Тестирование пользовательского потока
  - [ ] Создание и редактирование заявок
  - [ ] Создание тикетов и обмен сообщениями
- [ ] Тестирование административных функций
  - [ ] Работа с заявками (одобрение, отклонение, удаление)
  - [ ] Работа с тикетами (просмотр, ответы, закрытие)
  - [ ] Тестирование бэкапов
- [ ] Проверка обработки медиафайлов
  - [ ] Загрузка и отображение различных типов медиа
  - [ ] Тестирование ограничений на количество медиа 